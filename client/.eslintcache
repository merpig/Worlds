[{"C:\\Users\\merpi\\OneDrive\\Desktop\\worldsProject\\worlds\\client\\src\\index.js":"1","C:\\Users\\merpi\\OneDrive\\Desktop\\worldsProject\\worlds\\client\\src\\App.js":"2","C:\\Users\\merpi\\OneDrive\\Desktop\\worldsProject\\worlds\\client\\src\\reportWebVitals.js":"3","C:\\Users\\merpi\\OneDrive\\Desktop\\worldsProject\\worlds\\client\\src\\pages\\Profile.js":"4","C:\\Users\\merpi\\OneDrive\\Desktop\\worldsProject\\worlds\\client\\src\\pages\\Signup.js":"5","C:\\Users\\merpi\\OneDrive\\Desktop\\worldsProject\\worlds\\client\\src\\pages\\Home.js":"6","C:\\Users\\merpi\\OneDrive\\Desktop\\worldsProject\\worlds\\client\\src\\pages\\Login.js":"7","C:\\Users\\merpi\\OneDrive\\Desktop\\worldsProject\\worlds\\client\\src\\components\\Header\\index.js":"8","C:\\Users\\merpi\\OneDrive\\Desktop\\worldsProject\\worlds\\client\\src\\components\\Footer\\index.js":"9","C:\\Users\\merpi\\OneDrive\\Desktop\\worldsProject\\worlds\\client\\src\\utils\\mutations.js":"10","C:\\Users\\merpi\\OneDrive\\Desktop\\worldsProject\\worlds\\client\\src\\utils\\subscriptions.js":"11","C:\\Users\\merpi\\OneDrive\\Desktop\\worldsProject\\worlds\\client\\src\\utils\\queries.js":"12","C:\\Users\\merpi\\OneDrive\\Desktop\\worldsProject\\worlds\\client\\src\\utils\\auth.js":"13","C:\\Users\\merpi\\OneDrive\\Desktop\\worldsProject\\worlds\\client\\src\\components\\WorldList\\index.js":"14","C:\\Users\\merpi\\OneDrive\\Desktop\\worldsProject\\worlds\\client\\src\\components\\WorldList\\CreateWorld.js":"15","C:\\Users\\merpi\\OneDrive\\Desktop\\worldsProject\\worlds\\client\\src\\components\\WorldList\\WorldCard.js":"16","C:\\Users\\merpi\\OneDrive\\Desktop\\worldsProject\\worlds\\client\\src\\Main.js":"17","C:\\Users\\merpi\\OneDrive\\Desktop\\worldsProject\\worlds\\client\\src\\components\\Messages\\index.js":"18","C:\\Users\\merpi\\OneDrive\\Desktop\\worldsProject\\worlds\\client\\src\\pages\\World.js":"19","C:\\Users\\merpi\\OneDrive\\Desktop\\worldsProject\\worlds\\client\\src\\pages\\Users.js":"20"},{"size":517,"mtime":1634218142306,"results":"21","hashOfConfig":"22"},{"size":1773,"mtime":1636415007441,"results":"23","hashOfConfig":"22"},{"size":375,"mtime":1634218142308,"results":"24","hashOfConfig":"22"},{"size":9986,"mtime":1637020792911,"results":"25","hashOfConfig":"22"},{"size":2866,"mtime":1637032086435,"results":"26","hashOfConfig":"22"},{"size":1152,"mtime":1637030780026,"results":"27","hashOfConfig":"22"},{"size":2855,"mtime":1637032117324,"results":"28","hashOfConfig":"22"},{"size":1471,"mtime":1636725489561,"results":"29","hashOfConfig":"22"},{"size":882,"mtime":1636859932491,"results":"30","hashOfConfig":"22"},{"size":2878,"mtime":1636654817515,"results":"31","hashOfConfig":"22"},{"size":1276,"mtime":1636834829278,"results":"32","hashOfConfig":"22"},{"size":1211,"mtime":1636834562525,"results":"33","hashOfConfig":"22"},{"size":1084,"mtime":1634218142310,"results":"34","hashOfConfig":"22"},{"size":987,"mtime":1636866997863,"results":"35","hashOfConfig":"22"},{"size":3732,"mtime":1636874144554,"results":"36","hashOfConfig":"22"},{"size":2197,"mtime":1636864028884,"results":"37","hashOfConfig":"22"},{"size":8589,"mtime":1636846805472,"results":"38","hashOfConfig":"22"},{"size":11432,"mtime":1636876940268,"results":"39","hashOfConfig":"22"},{"size":7424,"mtime":1636982385443,"results":"40","hashOfConfig":"22"},{"size":605,"mtime":1635262250327,"results":"41","hashOfConfig":"22"},{"filePath":"42","messages":"43","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"44"},"49937c",{"filePath":"45","messages":"46","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"44"},{"filePath":"47","messages":"48","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"44"},{"filePath":"49","messages":"50","errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"51","messages":"52","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"53","messages":"54","errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"55","messages":"56","errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"57","messages":"58","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"44"},{"filePath":"59","messages":"60","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"44"},{"filePath":"61","messages":"62","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"44"},{"filePath":"63","messages":"64","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"44"},{"filePath":"65","messages":"66","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"44"},{"filePath":"67","messages":"68","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"44"},{"filePath":"69","messages":"70","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"44"},{"filePath":"71","messages":"72","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"44"},{"filePath":"73","messages":"74","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"44"},{"filePath":"75","messages":"76","errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"77","usedDeprecatedRules":"44"},{"filePath":"78","messages":"79","errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"80","usedDeprecatedRules":"44"},{"filePath":"81","messages":"82","errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"83","usedDeprecatedRules":"44"},{"filePath":"84","messages":"85","errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"86","usedDeprecatedRules":"44"},"C:\\Users\\merpi\\OneDrive\\Desktop\\worldsProject\\worlds\\client\\src\\index.js",[],["87","88"],"C:\\Users\\merpi\\OneDrive\\Desktop\\worldsProject\\worlds\\client\\src\\App.js",[],"C:\\Users\\merpi\\OneDrive\\Desktop\\worldsProject\\worlds\\client\\src\\reportWebVitals.js",[],"C:\\Users\\merpi\\OneDrive\\Desktop\\worldsProject\\worlds\\client\\src\\pages\\Profile.js",["89","90"],"C:\\Users\\merpi\\OneDrive\\Desktop\\worldsProject\\worlds\\client\\src\\pages\\Signup.js",[],"C:\\Users\\merpi\\OneDrive\\Desktop\\worldsProject\\worlds\\client\\src\\pages\\Home.js",["91"],"C:\\Users\\merpi\\OneDrive\\Desktop\\worldsProject\\worlds\\client\\src\\pages\\Login.js",["92"],"C:\\Users\\merpi\\OneDrive\\Desktop\\worldsProject\\worlds\\client\\src\\components\\Header\\index.js",[],"C:\\Users\\merpi\\OneDrive\\Desktop\\worldsProject\\worlds\\client\\src\\components\\Footer\\index.js",[],"C:\\Users\\merpi\\OneDrive\\Desktop\\worldsProject\\worlds\\client\\src\\utils\\mutations.js",[],"C:\\Users\\merpi\\OneDrive\\Desktop\\worldsProject\\worlds\\client\\src\\utils\\subscriptions.js",[],"C:\\Users\\merpi\\OneDrive\\Desktop\\worldsProject\\worlds\\client\\src\\utils\\queries.js",[],"C:\\Users\\merpi\\OneDrive\\Desktop\\worldsProject\\worlds\\client\\src\\utils\\auth.js",[],"C:\\Users\\merpi\\OneDrive\\Desktop\\worldsProject\\worlds\\client\\src\\components\\WorldList\\index.js",[],"C:\\Users\\merpi\\OneDrive\\Desktop\\worldsProject\\worlds\\client\\src\\components\\WorldList\\CreateWorld.js",[],"C:\\Users\\merpi\\OneDrive\\Desktop\\worldsProject\\worlds\\client\\src\\components\\WorldList\\WorldCard.js",[],"C:\\Users\\merpi\\OneDrive\\Desktop\\worldsProject\\worlds\\client\\src\\Main.js",["93","94"],"import React, { useState, useEffect } from 'react';\r\nimport { useQuery, useMutation, useSubscription } from '@apollo/client';\r\nimport { BrowserRouter as Router, Route, Redirect, useParams } from 'react-router-dom';\r\nimport { Beforeunload } from 'react-beforeunload';\r\n\r\nimport Home from './pages/Home';\r\nimport Signup from './pages/Signup';\r\nimport Login from './pages/Login';\r\nimport Profile from './pages/Profile';\r\nimport Header from './components/Header';\r\nimport Footer from './components/Footer';\r\nimport Messages from './components/Messages';\r\nimport World from './pages/World';\r\nimport Users from './pages/Users';\r\n\r\nimport Auth from './utils/auth';\r\n\r\nimport { QUERY_ME, QUERY_FRIENDS } from './utils/queries';\r\nimport { LOGOUT_USER } from './utils/mutations';\r\nimport { \r\n  FRIEND_ADDED, \r\n  FRIEND_CANCELED, \r\n  FRIEND_UPDATED, \r\n  MESSAGE_SENT,\r\n  LOGGED_IN,\r\n  LOGGED_OUT\r\n} from './utils/subscriptions';\r\n\r\nconst Main = () => {\r\n    const { loading, data, error } = useQuery(QUERY_ME);\r\n    const { loading: friendsLoading, data: friendsData} = useQuery(QUERY_FRIENDS);\r\n\r\n    const [logout] = useMutation(LOGOUT_USER)\r\n\r\n    const { loading: newFriendDataLoading, data: newFriendData} = useSubscription(FRIEND_ADDED);\r\n    const { loading: friendUpdatedLoading, data: friendUpdatedData} = useSubscription(FRIEND_UPDATED);\r\n    const { loading: friendCanceledLoading, data: friendCanceledData} = useSubscription(FRIEND_CANCELED);\r\n    const { loading: messageLoading, data: messageData} = useSubscription(MESSAGE_SENT);\r\n    const { loading: loggedInLoading, data: loggedInData, error: loggedInError} = useSubscription(LOGGED_IN);\r\n    const { loading: loggedOutLoading, data: loggedOutData, error: loggedOutError} = useSubscription(LOGGED_OUT);\r\n\r\n\r\n    const [friends,setFriends]=useState([]);\r\n    const [worlds,setWorlds]=useState([]);\r\n    const [messageFromProfile,setMessageFromProfile]=useState({});\r\n    const [showNavFooter,setShowNavFooter]=useState(true);\r\n\r\n    useEffect(()=>{\r\n      Auth.loggedIn()\r\n    },[])\r\n\r\n    useEffect(()=>{\r\n      //console.log(loggedInLoading,loggedInData,loggedInError)\r\n      if(!loggedInLoading&&loggedInData){\r\n        const id = loggedInData.loggedIn._id;\r\n        setFriends(friends=>{\r\n          const index = friends.findIndex(e=>e.receiving._id===id||e.requesting._id===id);\r\n          let friendToUpdate = {...friends[index]};\r\n          let receiving = {...friendToUpdate.receiving}\r\n          let requesting = {...friendToUpdate.requesting}\r\n          receiving._id===id?\r\n            receiving.status=\"online\":\r\n            requesting.status=\"online\";\r\n          return [\r\n            ...friends.slice(0,index),\r\n            {...friendToUpdate,receiving,requesting},\r\n            ...friends.slice(index+1)\r\n            ]\r\n        })\r\n      }\r\n    },[loggedInLoading,loggedInData,loggedInError])\r\n\r\n    useEffect(()=>{\r\n      //console.log(loggedOutLoading,loggedOutData,loggedOutError)\r\n      if(!loggedOutLoading&&loggedOutData){\r\n        const id = loggedOutData.loggedOut._id;\r\n        setFriends(friends=>{\r\n          const index = friends.findIndex(e=>e.receiving._id===id||e.requesting._id===id);\r\n          let friendToUpdate = {...friends[index]};\r\n          let receiving = {...friendToUpdate.receiving}\r\n          let requesting = {...friendToUpdate.requesting}\r\n          receiving._id===id?\r\n            receiving.status=\"offline\":\r\n            requesting.status=\"offline\";\r\n          return [\r\n            ...friends.slice(0,index),\r\n            {...friendToUpdate,receiving,requesting},\r\n            ...friends.slice(index+1)\r\n            ]\r\n        })\r\n      }\r\n    },[loggedOutLoading,loggedOutData,loggedOutError])\r\n\r\n    useEffect(()=>{\r\n        if(!loading&&data)\r\n            setWorlds([...data.me.worlds]);\r\n    },[loading,data]);\r\n\r\n    useEffect(()=>{\r\n        if(!friendsLoading&&friendsData)\r\n            setFriends([...friendsData.friends]);\r\n    },[friendsLoading,friendsData]);\r\n\r\n    useEffect(()=>{\r\n        if(!messageLoading&&messageData){\r\n            setFriends(friends=>{\r\n                let index = friends.findIndex(e=>e._id===messageData.messageSent._id);\r\n                let updatedFriend = {...friends[index]};\r\n                let messageIndex = updatedFriend.messages.length;\r\n                for(let i = updatedFriend.messages.length-1; i>=0;i--){\r\n                  if(updatedFriend.messages[i].message === messageData.messageSent.message.message &&\r\n                    updatedFriend.messages[i].sender.username===messageData.messageSent.message.sender.username&&\r\n                    updatedFriend.messages[i].status===0){\r\n                      messageIndex = i;\r\n                    }\r\n                }\r\n                updatedFriend.messages= [\r\n                  ...updatedFriend.messages.slice(0,messageIndex),\r\n                  messageData.messageSent.message,\r\n                  ...updatedFriend.messages.slice(messageIndex+1)\r\n                ];\r\n                return [\r\n                ...friends.slice(0,index),\r\n                updatedFriend,\r\n                ...friends.slice(index+1)\r\n                ]\r\n            });\r\n        }\r\n    },[messageLoading,messageData]);\r\n\r\n    useEffect(()=>{\r\n        if(!newFriendDataLoading&&newFriendData){\r\n        setFriends(friends=>[...friends,newFriendData.friendAdded]);\r\n        } \r\n    },[newFriendData, newFriendDataLoading]);\r\n\r\n    useEffect(()=>{ \r\n        if(!friendUpdatedLoading&&friendUpdatedData){\r\n        setFriends(friends=>{\r\n            let {friendUpdated} = friendUpdatedData;\r\n            let index = friends.findIndex(friend=>\r\n            friend.requesting.username===friendUpdated.requesting.username&&\r\n            friend.receiving.username===friendUpdated.receiving.username\r\n            )\r\n            let updatedFriend = {...friends[index]};\r\n            updatedFriend.status = friendUpdated.status\r\n            return [\r\n            ...friends.slice(0,index),\r\n            updatedFriend,\r\n            ...friends.slice(index+1)\r\n            ]\r\n        });\r\n        }\r\n    },[friendUpdatedData, friendUpdatedLoading]);\r\n\r\n    useEffect(()=>{ \r\n        if(!friendCanceledLoading&&friendCanceledData){\r\n        setFriends(friends=>{\r\n            let {friendCanceled} = friendCanceledData;\r\n            let index = friends.findIndex(friend=>\r\n            friend.requesting.username===friendCanceled.requesting.username&&\r\n            friend.receiving.username===friendCanceled.receiving.username\r\n            )\r\n            return [\r\n            ...friends.slice(0,index),\r\n            ...friends.slice(index+1)\r\n            ]\r\n        });\r\n        }\r\n    },[friendCanceledData, friendCanceledLoading]);\r\n\r\n    const beforeUnload = () => {\r\n      //logout();\r\n    }\r\n\r\n    return(<Beforeunload onBeforeunload={beforeUnload}>\r\n      <Router>\r\n        <div className=\"flex-column justify-flex-start min-100-vh\">\r\n          {showNavFooter?<Header />:[]}\r\n          <div className=\"container\">\r\n            <Route exact path=\"/\">\r\n              <Home \r\n                loading={loading}\r\n                data={data}\r\n                worlds={worlds}\r\n                setWorlds={setWorlds}\r\n                setShowNavFooter={setShowNavFooter}\r\n              />\r\n            </Route>\r\n            <Route exact path=\"/login\">\r\n              <Login setShowNavFooter={setShowNavFooter}/>\r\n            </Route>\r\n            <Route exact path=\"/signup\">\r\n              <Signup setShowNavFooter={setShowNavFooter}/>\r\n            </Route>\r\n            <Route exact path=\"/me\">\r\n              <Profile \r\n                loading={loading} \r\n                data={data} \r\n                error={error} \r\n                friends={friends} \r\n                friendsLoading={friendsLoading}\r\n                setFromProfile={setMessageFromProfile}\r\n                setShowNavFooter={setShowNavFooter}\r\n                />\r\n            </Route>\r\n            <Route exact path=\"/users/:id\">\r\n              <Users />\r\n            </Route>\r\n            <Route exact path=\"/users\">\r\n              <Users />\r\n            </Route>\r\n            <Route exact path=\"/world/:id\">\r\n              {<World setShowNavFooter={setShowNavFooter}/>}\r\n            </Route>\r\n            <Route exact path=\"/world\">\r\n              <Redirect to=\"/\"/>\r\n            </Route>\r\n          </div>\r\n          {Auth.loggedIn()?<Messages friends={friends} data={data} fromProfile={messageFromProfile} setFriends={setFriends}/>:[]}\r\n          {showNavFooter?<Footer />:[]}\r\n        </div>\r\n    </Router></Beforeunload>);\r\n}\r\n\r\nexport default Main;","C:\\Users\\merpi\\OneDrive\\Desktop\\worldsProject\\worlds\\client\\src\\components\\Messages\\index.js",["95","96"],"import React, { useState, useEffect } from 'react';\r\n\r\nimport { SEND_MESSAGE } from '../../utils/mutations';\r\nimport { useMutation } from '@apollo/client';\r\n\r\nimport './index.css'\r\n\r\nconst MessagesButton = ({setShowMessages}) => {\r\n    return(\r\n        <div className=\"message-button circle\" onClick={()=>setShowMessages(true)}>\r\n            💬\r\n        </div>\r\n    )\r\n}\r\n\r\nconst FriendsWithMessage = ({setShowMessages,setShowFriends,friends,data,setFriend,setId}) => {\r\n    const [input,setInput] = useState('')\r\n    const friendsWithMessages = friends.filter(friend=>friend.messages.length);\r\n    //console.log(friendsWithMessages)\r\n    const inputChange = (e) => {\r\n        setInput(e.target.value);\r\n    }\r\n    \r\n    const handleFriendClick = ({friend,id}) => {\r\n        setFriend(friend);\r\n        setId(id);\r\n        setShowFriends(false);\r\n    }\r\n\r\n    const convertTime = epoch => {\r\n        let d = new Date(parseInt(epoch)).toLocaleString().replace(',','').split(' ');\r\n        let today = new Date().toLocaleString().replace(',','').split(' ');;\r\n        if(d[0]===today[0]){\r\n            let [hour,minute] = d[1].split(\":\");\r\n            return `${hour}:${minute} ${d[2]}`\r\n        }\r\n        return d[0]\r\n    }\r\n\r\n    return (\r\n        <div>\r\n            <div className=\"message-header p-3\">\r\n                <div className=\"new-message circle-mid\" onClick={()=>setShowFriends(false)}>✉</div>\r\n                <h3>Messages</h3>\r\n                <div className=\"message-close alt-circle\" onClick={()=>setShowMessages(false)}>✖</div>\r\n            </div>\r\n            <div className=\"row\">\r\n                <div className=\"col-12\">\r\n                    <form className=\"message-search\">\r\n                        <input className=\"form-input\" onChange={e=>inputChange(e)} value={input} placeholder=\"Search\"></input>\r\n                    </form>\r\n                </div>\r\n            </div>\r\n            <div className=\"row friends-with-messages\">\r\n                {friendsWithMessages.length?\r\n                    friendsWithMessages\r\n                        .filter(friend=>{\r\n                            return (friend.receiving.username.includes(input)&&friend.receiving.username!==data.me.username)||\r\n                            (friend.requesting.username.includes(input)&&friend.requesting.username!==data.me.username)}\r\n                        )\r\n                        .map(f=>({\r\n                            username: f.receiving.username===data.me.username?f.requesting.username:f.receiving.username,\r\n                            status:f.receiving.username===data.me.username?f.requesting.status:f.receiving.status,\r\n                            id: f._id,\r\n                            messages: f.messages,\r\n                            lastSent: f.messages[f.messages.length-1].createdAt\r\n                        }))\r\n                        .sort((a,b)=>b.lastSent-a.lastSent)\r\n                        .map(f=><div key={f.id} className=\"col-12\">\r\n                            <div className=\"message-friend\" onClick={()=>{handleFriendClick({friend:f.username,id:f.id})}}>\r\n                                <h6><div className={`status-circle ${f.status===\"online\"?\"online\":\"offline\"}`}></div>{f.username}</h6>\r\n                                <p className=\"mb-0 last-message\">{f.messages[f.messages.length-1].message}</p>\r\n                                <div className=\"last-message-time\">{convertTime(f.messages[f.messages.length-1].createdAt)}\r\n                                    \r\n                                </div>\r\n                            </div>\r\n                        </div>):\r\n                    <div className=\"no-messages\">No messages</div>}\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nconst MessagesWithFriend = ({setShowMessages,setShowFriends,friend,setFriend,friends,data,_id,fromProfile,setFriends}) => {\r\n    const [sendMessage] = useMutation(SEND_MESSAGE)\r\n    const [title,setTitle] = useState(friend.length?friend:'New Message');\r\n    const [search,setSearch] = useState('');\r\n    const [message,setMessage] = useState('');\r\n    const [showSearch,setShowSearch] = useState(friend.length?false:true);\r\n    const [friendId,setFriendId] = useState(_id?_id:'');\r\n    const [errorMsg,setErrorMsg] = useState('')\r\n    const [newMsg,setNewMsg]=useState(null);\r\n\r\n    useEffect(()=>{\r\n        if(fromProfile.show){\r\n            setTitle(fromProfile.friend);\r\n            setFriendId(fromProfile.id);\r\n        }\r\n    },[fromProfile])\r\n\r\n    const [filteredFriend] = friends.filter(f=>{\r\n        return f.requesting.username===title||f.receiving.username===title\r\n    })\r\n\r\n    let messages = title==='New Message'?[]:[...filteredFriend?.messages||[]].reverse();\r\n    if(title!=='New Message'&&!filteredFriend) {\r\n        return <>{setShowFriends(true)}</>;\r\n    }\r\n\r\n    const handleFriendClick = ({id,username}) => {\r\n        setTitle(username);\r\n        setFriendId(id);\r\n        setShowSearch(false);\r\n    }\r\n\r\n    const handleSendMessage = async (e) => {\r\n        e.preventDefault();\r\n        if(!message.length) return;\r\n        let index = friends.findIndex(f=>f._id===friendId);\r\n        let updatedFriend = {...friends[index]}\r\n        updatedFriend.messages = [\r\n            ...updatedFriend.messages,\r\n            {\r\n                message,\r\n                sender: {\r\n                    username: data.me.username\r\n                },\r\n                status: 0,\r\n                _id: updatedFriend.messages.length\r\n            }\r\n        ];\r\n        setFriends([\r\n            ...friends.slice(0,index),\r\n            updatedFriend,\r\n            ...friends.slice(index+1)\r\n        ]);\r\n        try {\r\n            await sendMessage({\r\n                variables: {id: friendId,message}\r\n            });\r\n            setMessage('');\r\n        } catch(e){\r\n            console.log(e.message)\r\n            setErrorMsg(e.message);\r\n        }\r\n    }\r\n\r\n    return (\r\n        <div>\r\n            <div className=\"message-header p-3\">\r\n                <div className=\"new-message circle-mid\" onClick={()=>{setShowFriends(true);setFriend('');}}>←</div>\r\n                <h3 className=\"ml-3\">{title}</h3>\r\n                <div className=\"message-close alt-circle\" onClick={()=>setShowMessages(false)}>✖</div>\r\n            </div>\r\n            {showSearch?<div className=\"row\">\r\n                <div className=\"col-12\">\r\n                    <form className=\"message-search\" onSubmit={e=>e.preventDefault()}>\r\n                        <input className=\"form-input\" onChange={e=>setSearch(e.target.value)} value={search} placeholder=\"Search friends\"></input>\r\n                    </form>\r\n                </div>\r\n            </div>:[]}\r\n            {showSearch?\r\n            <div className=\"row search-friends-container\">\r\n                {\r\n                    friends\r\n                        .filter(f=>{\r\n                            return ((f.receiving.username.includes(search)&&f.receiving.username!==data.me.username)||\r\n                            (f.requesting.username.includes(search)&&f.requesting.username!==data.me.username))&&f.status===1}\r\n                        )\r\n                        .map(f=>({\r\n                            username: f.receiving.username===data.me.username?f.requesting.username:f.receiving.username,\r\n                            id: f._id\r\n                        }))\r\n                        .map(f=>\r\n                            <div key={f.id} className=\"col-12\">\r\n                                <div className=\"search-friend\" onClick={()=>handleFriendClick(f)}>\r\n                                    {f.username}\r\n                                </div>\r\n                            </div>\r\n                        )\r\n                }\r\n            </div>:\r\n            <div className=\"row\">\r\n                <div className=\"col-12\">\r\n                    <div className=\"messages p-2\">\r\n                        {\r\n                            messages.map(m=>m.sender.username===title?\r\n                                <div key={m._id} className=\"row mb-1\">\r\n                                    <div className=\"col-8\">\r\n                                        <div className=\"from-friend\">{m.message}</div><div></div>\r\n                                    </div>\r\n                                    <div className=\"col-4\">\r\n                                    </div>\r\n                                </div>:\r\n                                <div key={m._id} className=\"row mb-1\">\r\n                                    <div className=\"col-4\">\r\n                                    </div>\r\n                                    <div className=\"col-8\">\r\n                                        <div className={`from-me status-${m.status}`}>{m.message}</div>\r\n                                    </div>\r\n                                </div>\r\n                            )\r\n                        }\r\n                        {errorMsg?errorMsg:\"\"}\r\n                    </div>\r\n                </div>\r\n            </div>}\r\n            {showSearch?[]:\r\n                <form onSubmit={handleSendMessage}>\r\n                    <div className=\"row send-message px-2\">\r\n                        <div className=\"col-10 pr-0\">\r\n                            <input className=\"form-input send-message-input\" placeholder=\"message\" value={message} onChange={e=>setMessage(e.target.value)}>\r\n                            </input>\r\n                        </div>\r\n                        <div className=\"col-2 pl-0 py-2\">\r\n                            <div className=\"message-sent-btn\" onClick={handleSendMessage}>\r\n                                Send\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </form>\r\n            }\r\n        </div>\r\n    )\r\n}\r\n\r\nconst Messages = ({friends,data,fromProfile,setFriends}) => {\r\n    const [showMessages,setShowMessages] = useState(false);\r\n    const [showFriends,setShowFriends] = useState(true);\r\n    const [friend,setFriend] = useState('');\r\n    const [id,setId] = useState('');\r\n\r\n    useEffect(()=>{\r\n        if(fromProfile.show){\r\n            setShowMessages(fromProfile.show)\r\n            setShowFriends(fromProfile.showFriend)\r\n            setFriend(fromProfile.friend)\r\n            setId(fromProfile.id)\r\n        }\r\n    },[fromProfile])\r\n\r\n    return (\r\n        showMessages?\r\n            <div className=\"message-container\">\r\n                {(showFriends)?\r\n                    <FriendsWithMessage\r\n                        setShowMessages={setShowMessages}\r\n                        setShowFriends={setShowFriends}\r\n                        friends={friends}\r\n                        data={data}\r\n                        setFriend={setFriend}\r\n                        setId={setId}\r\n                    />:\r\n                    <MessagesWithFriend\r\n                        setShowMessages={setShowMessages}\r\n                        setShowFriends={setShowFriends} \r\n                        friend={friend} \r\n                        setFriend={setFriend}\r\n                        setId={setId}\r\n                        friends={friends}\r\n                        data={data}\r\n                        _id={id}\r\n                        fromProfile={fromProfile}\r\n                        setFriends={setFriends}\r\n                    />}\r\n            </div>:\r\n            <MessagesButton setShowMessages={setShowMessages}/>\r\n    )\r\n}\r\n\r\nexport default Messages;","C:\\Users\\merpi\\OneDrive\\Desktop\\worldsProject\\worlds\\client\\src\\pages\\World.js",["97","98","99"],"import React, { useEffect } from 'react';\r\nimport { Redirect, useParams } from 'react-router-dom';\r\nimport { useMutation } from '@apollo/client';\r\nimport { ENTER_WORLD } from '../utils/mutations';\r\nimport * as THREE from \"three\";\r\nimport Auth from '../utils/auth';\r\nimport \"./World.css\";\r\nimport { OrbitControls } from \"three/examples/jsm/controls/OrbitControls\";\r\n\r\nconst CameraControls = (camera, renderer,scene) => {\r\n    let controls = new OrbitControls( camera , renderer.domElement);\r\n    controls.enabled = true;\r\n    controls.enableDamping = true;   //damping \r\n    controls.dampingFactor = 0.15;   //damping inertia\r\n    controls.enableZoom = true;      //Zooming\r\n    controls.autoRotate = false;     //Enable auto rotation\r\n    controls.minDistance = (2+5);\r\n    controls.maxDistance = (2+5)+20;\r\n    controls.enablePan = false;\r\n    controls.keys = {\r\n        LEFT: null, //left arrow\r\n        UP: null, // up arrow\r\n        RIGHT: null, // right arrow\r\n        BOTTOM: null // down arrow\r\n    };\r\n    controls.addEventListener(\"change\", (e) => {\r\n        if (renderer) renderer.render(scene, camera);\r\n    });\r\n    return controls;\r\n}\r\n\r\nconst RenderWorld = ({id}) => {\r\n    \r\n    const [enterWorld, {data, loading, error}] = useMutation(ENTER_WORLD);\r\n    // const [exitWorld, {data, loading, error}] = useMutation(EXIT_WORLD);\r\n    const world = data?.enterWorld || {};\r\n\r\n    // Set up the scene\r\n    let scene = new THREE.Scene();\r\n    let camera = new THREE.PerspectiveCamera( 75, window.innerWidth/window.innerHeight, .1, 1000 );\r\n    let renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });\r\n    let raycaster = new THREE.Raycaster();\r\n    let mouse = new THREE.Vector2();\r\n    //let controls = CameraControls(camera, renderer,scene);\r\n\r\n    renderer.setClearColor(new THREE.Color(\"black\"),1);\r\n    renderer.domElement.className = \"canvas\";\r\n    renderer.setSize( window.innerWidth, window.innerHeight);\r\n\r\n    camera.position.z = 5;\r\n    camera.position.y = 5;\r\n    camera.position.x = 5;\r\n    camera.lookAt(new THREE.Vector3(5,5,0))\r\n    let xRotation = .5;\r\n    camera.translateZ(-5);\r\n    //camera.translateY(5);\r\n    camera.rotateX(.5);\r\n    camera.translateZ(5);\r\n    //camera.translateY(-5);\r\n\r\n\r\n\r\n\r\n    renderer.render( scene, camera );\r\n\r\n    window.addEventListener(\"resize\", \r\n        () => {\r\n            let tanFOV = Math.tan( ( ( Math.PI / 180 ) * camera.fov / 2 ) );\r\n            let windowHeight = window.innerHeight;\r\n\r\n            camera.aspect = window.innerWidth / window.innerHeight;\r\n            \r\n            // adjust the FOV\r\n            camera.fov = ( 360 / Math.PI ) * Math.atan( tanFOV * ( window.innerHeight / windowHeight ) );\r\n            \r\n            camera.updateProjectionMatrix();\r\n            camera.lookAt( scene.position );\r\n\r\n            renderer.setSize( window.innerWidth, window.innerHeight );\r\n            renderer.render( scene, camera );\r\n        }, false\r\n    );\r\n\r\n    window.addEventListener(\"keydown\",e=>{\r\n        switch(e.key){\r\n            case 'ArrowRight':\r\n                camera.translateZ(-5);\r\n                camera.rotateX(-xRotation)\r\n                camera.rotateZ(.1);\r\n                camera.rotateX(xRotation)\r\n                camera.translateZ(5);\r\n                break;\r\n            case 'ArrowLeft':\r\n                camera.translateZ(-5);\r\n                camera.rotateX(-xRotation)\r\n                camera.rotateZ(-.1);\r\n                camera.rotateX(xRotation)\r\n                camera.translateZ(5);\r\n                break;\r\n            case 'ArrowDown':\r\n                if(xRotation<1) xRotation+=.1\r\n                else break;\r\n                camera.translateZ(-5);\r\n                camera.rotateX(.1);\r\n                camera.translateZ(5);\r\n                break;\r\n            case 'ArrowUp':\r\n                if(xRotation>.2) xRotation-=.1\r\n                else break;\r\n                camera.translateZ(-5);\r\n                camera.rotateX(-.1);\r\n                camera.translateZ(5);\r\n                break;\r\n            default:\r\n        }\r\n    });\r\n\r\n    function onMouseDown(e) {\r\n        // update mouse position\r\n        mouse.x = (e.clientX / window.innerWidth) * 2 - 1;\r\n        mouse.y = -(e.clientY / window.innerHeight) * 2 + 1;\r\n        \r\n        // Set the raycaster to check for intersected objects\r\n        raycaster.setFromCamera( mouse, camera );\r\n\r\n        const intersects = raycaster.intersectObjects( scene.children );\r\n\r\n        console.log(intersects);\r\n    }\r\n\r\n    useEffect(()=>{\r\n        console.log(id)\r\n        try{\r\n            enterWorld({\r\n                variables: {id}\r\n            });\r\n            function removeElementsByClass(className){\r\n                const elements = document.getElementsByClassName(className);\r\n                while(elements.length > 0){\r\n                    elements[0].parentNode.removeChild(elements[0]);\r\n                }\r\n            }\r\n            removeElementsByClass(\"canvas\");\r\n    \r\n            document.querySelector('.world-container').appendChild( renderer.domElement );\r\n            window.addEventListener(\"pointerdown\",onMouseDown,false);\r\n        }catch(e){\r\n            console.log(e)\r\n        }\r\n\r\n        return function cleanup () {\r\n            window.removeEventListener(\"pointerdown\",onMouseDown,false);\r\n        }\r\n    },[])\r\n\r\n    if(error){\r\n        console.log(error)\r\n        return <div>Error loading world</div>\r\n    }\r\n\r\n    if(loading || world==={}){\r\n        return <div>Loading</div>\r\n    }\r\n\r\n    const drawScene = () => {\r\n        const group = new THREE.Group();\r\n        for(let x = 0; x < 10; x++){\r\n            for(let y = 0; y < 10; y++){\r\n                var tile = new THREE.Shape();\r\n                tile.moveTo(x,y);\r\n                tile.lineTo(x,y+1);\r\n                tile.lineTo(x+1,y+1);\r\n                tile.lineTo(x+1,y);\r\n\r\n                const geometry = new THREE.ShapeGeometry(tile);\r\n                const material = new THREE.MeshBasicMaterial({\r\n                    color: `#aafa${Math.ceil((x+y)/2)}f`,\r\n                    side: THREE.FrontSide,\r\n                    depthWrite: true\r\n                });\r\n\r\n                const tileMesh = new THREE.Mesh(geometry,material);\r\n                tileMesh.name=\"floor\";\r\n                group.add(tileMesh);\r\n            }\r\n        }\r\n        scene.add(group)\r\n    }\r\n\r\n    const drawCharacter = () => {\r\n        var geometry = new THREE.SphereGeometry(.1, 50, 50, 0, Math.PI * 2, 0, Math.PI * 2);\r\n        var material = new THREE.MeshNormalMaterial();\r\n        var cube = new THREE.Mesh(geometry, material);\r\n        cube.translateZ(.1)\r\n        cube.position.x = 5;\r\n        cube.position.y=5;\r\n        scene.add(cube);\r\n    }\r\n\r\n    drawScene();\r\n    drawCharacter();\r\n\r\n    console.log(world)\r\n    let animate = () => {\r\n        requestAnimationFrame( animate );\r\n        //controls.update();\r\n        renderer.render( scene, camera );\r\n    };\r\n\r\n    animate();\r\n    return (\r\n        <div>\r\n            \r\n        </div>\r\n    )\r\n}\r\n\r\nconst World = ({setShowNavFooter}) => {\r\n    const { id } = useParams();\r\n    \r\n    useEffect(()=>{\r\n        setShowNavFooter(false);\r\n    },[]);\r\n\r\n    if(!Auth.loggedIn()) return <Redirect to=\"/login\" />\r\n    if(!id) return <Redirect to=\"/\"/>\r\n\r\n    return (\r\n        <div className=\"world-container\">\r\n            <RenderWorld id={id}/>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default World;","C:\\Users\\merpi\\OneDrive\\Desktop\\worldsProject\\worlds\\client\\src\\pages\\Users.js",["100"],"import React from 'react';\r\nimport { Redirect, useParams } from 'react-router-dom';\r\nimport { useQuery } from '@apollo/client';\r\n\r\nimport Auth from '../utils/auth';\r\n\r\nconst Users = () => {\r\n    const { id } = useParams();\r\n\r\n    if(!Auth.loggedIn()) return <Redirect to=\"/login\" />\r\n\r\n    console.log(id)\r\n    if( !id ) {\r\n        return (\r\n            <form>\r\n                <input className=\"form-input\" placeholder=\"Search for a user\">\r\n                </input>\r\n            </form>\r\n        )\r\n    }\r\n    \r\n    return (\r\n        <div>\r\n            \r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Users;",{"ruleId":"101","replacedBy":"102"},{"ruleId":"103","replacedBy":"104"},{"ruleId":"105","severity":1,"message":"106","line":249,"column":13,"nodeType":"107","endLine":249,"endColumn":55},{"ruleId":"108","severity":1,"message":"109","line":264,"column":9,"nodeType":"110","messageId":"111","endLine":264,"endColumn":28},{"ruleId":"112","severity":1,"message":"113","line":13,"column":5,"nodeType":"114","endLine":13,"endColumn":7,"suggestions":"115"},{"ruleId":"112","severity":1,"message":"113","line":15,"column":5,"nodeType":"114","endLine":15,"endColumn":7,"suggestions":"116"},{"ruleId":"108","severity":1,"message":"117","line":3,"column":52,"nodeType":"110","messageId":"111","endLine":3,"endColumn":61},{"ruleId":"108","severity":1,"message":"118","line":33,"column":12,"nodeType":"110","messageId":"111","endLine":33,"endColumn":18},{"ruleId":"108","severity":1,"message":"119","line":92,"column":12,"nodeType":"110","messageId":"111","endLine":92,"endColumn":18},{"ruleId":"108","severity":1,"message":"120","line":92,"column":19,"nodeType":"110","messageId":"111","endLine":92,"endColumn":28},{"ruleId":"108","severity":1,"message":"121","line":10,"column":7,"nodeType":"110","messageId":"111","endLine":10,"endColumn":21},{"ruleId":"112","severity":1,"message":"122","line":154,"column":7,"nodeType":"114","endLine":154,"endColumn":9,"suggestions":"123"},{"ruleId":"112","severity":1,"message":"113","line":223,"column":7,"nodeType":"114","endLine":223,"endColumn":9,"suggestions":"124"},{"ruleId":"108","severity":1,"message":"125","line":3,"column":10,"nodeType":"110","messageId":"111","endLine":3,"endColumn":18},"no-native-reassign",["126"],"no-negated-in-lhs",["127"],"jsx-a11y/img-redundant-alt","Redundant alt attribute. Screen-readers already announce `img` tags as an image. You don’t need to use the words `image`, `photo,` or `picture` (or any specified custom words) in the alt prop.","JSXOpeningElement","no-unused-vars","'renderCharacterInfo' is assigned a value but never used.","Identifier","unusedVar","react-hooks/exhaustive-deps","React Hook useEffect has a missing dependency: 'setShowNavFooter'. Either include it or remove the dependency array. If 'setShowNavFooter' changes too often, find the parent component that defines it and wrap that definition in useCallback.","ArrayExpression",["128"],["129"],"'useParams' is defined but never used.","'logout' is assigned a value but never used.","'newMsg' is assigned a value but never used.","'setNewMsg' is assigned a value but never used.","'CameraControls' is assigned a value but never used.","React Hook useEffect has missing dependencies: 'enterWorld', 'id', 'onMouseDown', and 'renderer.domElement'. Either include them or remove the dependency array.",["130"],["131"],"'useQuery' is defined but never used.","no-global-assign","no-unsafe-negation",{"desc":"132","fix":"133"},{"desc":"132","fix":"134"},{"desc":"135","fix":"136"},{"desc":"132","fix":"137"},"Update the dependencies array to be: [setShowNavFooter]",{"range":"138","text":"139"},{"range":"140","text":"139"},"Update the dependencies array to be: [enterWorld, id, onMouseDown, renderer.domElement]",{"range":"141","text":"142"},{"range":"143","text":"139"},[346,348],"[setShowNavFooter]",[488,490],[5331,5333],"[enterWorld, id, onMouseDown, renderer.domElement]",[7175,7177]]